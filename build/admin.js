(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,n=window.wp.components,r=window.wp.i18n,o=window.React;var i=e.n(o);const a=window.ReactDOM,l="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function s(e){const t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function d(e){return"nodeType"in e}function c(e){var t,n;return e?s(e)?e:d(e)&&null!=(t=null==(n=e.ownerDocument)?void 0:n.defaultView)?t:window:window}function u(e){const{Document:t}=c(e);return e instanceof t}function f(e){return!s(e)&&e instanceof c(e).HTMLElement}function v(e){return e instanceof c(e).SVGElement}function m(e){return e?s(e)?e.document:d(e)?u(e)?e:f(e)||v(e)?e.ownerDocument:document:document:document}const h=l?o.useLayoutEffect:o.useEffect;function p(e){const t=(0,o.useRef)(e);return h(()=>{t.current=e}),(0,o.useCallback)(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return null==t.current?void 0:t.current(...n)},[])}function g(e,t){void 0===t&&(t=[e]);const n=(0,o.useRef)(e);return h(()=>{n.current!==e&&(n.current=e)},t),n}function b(e,t){const n=(0,o.useRef)();return(0,o.useMemo)(()=>{const t=e(n.current);return n.current=t,t},[...t])}function w(e){const t=p(e),n=(0,o.useRef)(null),r=(0,o.useCallback)(e=>{e!==n.current&&(null==t||t(e,n.current)),n.current=e},[]);return[n,r]}function y(e){const t=(0,o.useRef)();return(0,o.useEffect)(()=>{t.current=e},[e]),t.current}let x={};function C(e,t){return(0,o.useMemo)(()=>{if(t)return t;const n=null==x[e]?0:x[e]+1;return x[e]=n,e+"-"+n},[e,t])}function S(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((t,n)=>{const r=Object.entries(n);for(const[n,o]of r){const r=t[n];null!=r&&(t[n]=r+e*o)}return t},{...t})}}const _=S(1),D=S(-1);function E(e){if(!e)return!1;const{KeyboardEvent:t}=c(e.target);return t&&e instanceof t}function R(e){if(function(e){if(!e)return!1;const{TouchEvent:t}=c(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return function(e){return"clientX"in e&&"clientY"in e}(e)?{x:e.clientX,y:e.clientY}:null}const N=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[N.Translate.toString(e),N.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),j="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function M(e){return e.matches(j)?e:e.querySelector(j)}const k={display:"none"};function I(e){let{id:t,value:n}=e;return i().createElement("div",{id:t,style:k},n)}function T(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;return i().createElement("div",{id:t,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":r,"aria-atomic":!0},n)}const A=(0,o.createContext)(null),L={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},F={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function O(e){let{announcements:t=F,container:n,hiddenTextDescribedById:r,screenReaderInstructions:l=L}=e;const{announce:s,announcement:d}=function(){const[e,t]=(0,o.useState)("");return{announce:(0,o.useCallback)(e=>{null!=e&&t(e)},[]),announcement:e}}(),c=C("DndLiveRegion"),[u,f]=(0,o.useState)(!1);if((0,o.useEffect)(()=>{f(!0)},[]),function(e){const t=(0,o.useContext)(A);(0,o.useEffect)(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}((0,o.useMemo)(()=>({onDragStart(e){let{active:n}=e;s(t.onDragStart({active:n}))},onDragMove(e){let{active:n,over:r}=e;t.onDragMove&&s(t.onDragMove({active:n,over:r}))},onDragOver(e){let{active:n,over:r}=e;s(t.onDragOver({active:n,over:r}))},onDragEnd(e){let{active:n,over:r}=e;s(t.onDragEnd({active:n,over:r}))},onDragCancel(e){let{active:n,over:r}=e;s(t.onDragCancel({active:n,over:r}))}}),[s,t])),!u)return null;const v=i().createElement(i().Fragment,null,i().createElement(I,{id:r,value:l.draggable}),i().createElement(T,{id:c,announcement:d}));return n?(0,a.createPortal)(v,n):v}var z;function P(){}function B(e,t){return(0,o.useMemo)(()=>({sensor:e,options:null!=t?t:{}}),[e,t])}!function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"}(z||(z={}));const $=Object.freeze({x:0,y:0});function U(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function H(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function W(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function K(e){let{left:t,top:n,height:r,width:o}=e;return[{x:t,y:n},{x:t+o,y:n},{x:t,y:n+r},{x:t+o,y:n+r}]}function q(e,t){if(!e||0===e.length)return null;const[n]=e;return t?n[t]:n}function V(e,t,n){return void 0===t&&(t=e.left),void 0===n&&(n=e.top),{x:t+.5*e.width,y:n+.5*e.height}}const X=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=V(t,t.left,t.top),i=[];for(const e of r){const{id:t}=e,r=n.get(t);if(r){const n=U(V(r),o);i.push({id:t,data:{droppableContainer:e,value:n}})}}return i.sort(H)};function Q(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),a=o-r,l=i-n;if(r<o&&n<i){const n=t.width*t.height,r=e.width*e.height,o=a*l;return Number((o/(n+r-o)).toFixed(4))}return 0}const Y=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const e of r){const{id:r}=e,i=n.get(r);if(i){const n=Q(i,t);n>0&&o.push({id:r,data:{droppableContainer:e,value:n}})}}return o.sort(W)};function J(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:$}function G(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((t,n)=>({...t,top:t.top+e*n.y,bottom:t.bottom+e*n.y,left:t.left+e*n.x,right:t.right+e*n.x}),{...t})}}const Z=G(1);const ee={ignoreTransform:!1};function te(e,t){void 0===t&&(t=ee);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:t,transformOrigin:r}=c(e).getComputedStyle(e);t&&(n=function(e,t,n){const r=function(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}(t);if(!r)return e;const{scaleX:o,scaleY:i,x:a,y:l}=r,s=e.left-a-(1-o)*parseFloat(n),d=e.top-l-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),c=o?e.width/o:e.width,u=i?e.height/i:e.height;return{width:c,height:u,top:d,right:s+c,bottom:d+u,left:s}}(n,t,r))}const{top:r,left:o,width:i,height:a,bottom:l,right:s}=n;return{top:r,left:o,width:i,height:a,bottom:l,right:s}}function ne(e){return te(e,{ignoreTransform:!0})}function re(e,t){const n=[];return e?function r(o){if(null!=t&&n.length>=t)return n;if(!o)return n;if(u(o)&&null!=o.scrollingElement&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!f(o)||v(o))return n;if(n.includes(o))return n;const i=c(e).getComputedStyle(o);return o!==e&&function(e,t){void 0===t&&(t=c(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(e=>{const r=t[e];return"string"==typeof r&&n.test(r)})}(o,i)&&n.push(o),function(e,t){return void 0===t&&(t=c(e).getComputedStyle(e)),"fixed"===t.position}(o,i)?n:r(o.parentNode)}(e):n}function oe(e){const[t]=re(e,1);return null!=t?t:null}function ie(e){return l&&e?s(e)?e:d(e)?u(e)||e===m(e).scrollingElement?window:f(e)?e:null:null:null}function ae(e){return s(e)?e.scrollX:e.scrollLeft}function le(e){return s(e)?e.scrollY:e.scrollTop}function se(e){return{x:ae(e),y:le(e)}}var de;function ce(e){return!(!l||!e)&&e===document.scrollingElement}function ue(e){const t={x:0,y:0},n=ce(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height};return{isTop:e.scrollTop<=t.y,isLeft:e.scrollLeft<=t.x,isBottom:e.scrollTop>=r.y,isRight:e.scrollLeft>=r.x,maxScroll:r,minScroll:t}}!function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"}(de||(de={}));const fe={x:.2,y:.2};function ve(e,t,n,r,o){let{top:i,left:a,right:l,bottom:s}=n;void 0===r&&(r=10),void 0===o&&(o=fe);const{isTop:d,isBottom:c,isLeft:u,isRight:f}=ue(e),v={x:0,y:0},m={x:0,y:0},h=t.height*o.y,p=t.width*o.x;return!d&&i<=t.top+h?(v.y=de.Backward,m.y=r*Math.abs((t.top+h-i)/h)):!c&&s>=t.bottom-h&&(v.y=de.Forward,m.y=r*Math.abs((t.bottom-h-s)/h)),!f&&l>=t.right-p?(v.x=de.Forward,m.x=r*Math.abs((t.right-p-l)/p)):!u&&a<=t.left+p&&(v.x=de.Backward,m.x=r*Math.abs((t.left+p-a)/p)),{direction:v,speed:m}}function me(e){if(e===document.scrollingElement){const{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function he(e){return e.reduce((e,t)=>_(e,se(t)),$)}const pe=[["x",["left","right"],function(e){return e.reduce((e,t)=>e+ae(t),0)}],["y",["top","bottom"],function(e){return e.reduce((e,t)=>e+le(t),0)}]];class ge{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=re(t),r=he(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[e,t,o]of pe)for(const i of t)Object.defineProperty(this,i,{get:()=>{const t=o(n),a=r[e]-t;return this.rect[i]+a},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class be{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)})},this.target=e}add(e,t,n){var r;null==(r=this.target)||r.addEventListener(e,t,n),this.listeners.push([e,t,n])}}function we(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return"number"==typeof t?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t&&r>t.y}var ye,xe;function Ce(e){e.preventDefault()}function Se(e){e.stopPropagation()}!function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"}(ye||(ye={})),function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"}(xe||(xe={}));const _e={start:[xe.Space,xe.Enter],cancel:[xe.Esc],end:[xe.Space,xe.Enter,xe.Tab]},De=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case xe.Right:return{...n,x:n.x+25};case xe.Left:return{...n,x:n.x-25};case xe.Down:return{...n,y:n.y+25};case xe.Up:return{...n,y:n.y-25}}};class Ee{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new be(m(t)),this.windowListeners=new be(c(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ye.Resize,this.handleCancel),this.windowListeners.add(ye.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ye.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,n=e.node.current;n&&function(e,t){if(void 0===t&&(t=te),!e)return;const{top:n,left:r,bottom:o,right:i}=t(e);oe(e)&&(o<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}(n),t($)}handleKeyDown(e){if(E(e)){const{active:t,context:n,options:r}=this.props,{keyboardCodes:o=_e,coordinateGetter:i=De,scrollBehavior:a="smooth"}=r,{code:l}=e;if(o.end.includes(l))return void this.handleEnd(e);if(o.cancel.includes(l))return void this.handleCancel(e);const{collisionRect:s}=n.current,d=s?{x:s.left,y:s.top}:$;this.referenceCoordinates||(this.referenceCoordinates=d);const c=i(e,{active:t,context:n.current,currentCoordinates:d});if(c){const t=D(c,d),r={x:0,y:0},{scrollableAncestors:o}=n.current;for(const n of o){const o=e.code,{isTop:i,isRight:l,isLeft:s,isBottom:d,maxScroll:u,minScroll:f}=ue(n),v=me(n),m={x:Math.min(o===xe.Right?v.right-v.width/2:v.right,Math.max(o===xe.Right?v.left:v.left+v.width/2,c.x)),y:Math.min(o===xe.Down?v.bottom-v.height/2:v.bottom,Math.max(o===xe.Down?v.top:v.top+v.height/2,c.y))},h=o===xe.Right&&!l||o===xe.Left&&!s,p=o===xe.Down&&!d||o===xe.Up&&!i;if(h&&m.x!==c.x){const e=n.scrollLeft+t.x,i=o===xe.Right&&e<=u.x||o===xe.Left&&e>=f.x;if(i&&!t.y)return void n.scrollTo({left:e,behavior:a});r.x=i?n.scrollLeft-e:o===xe.Right?n.scrollLeft-u.x:n.scrollLeft-f.x,r.x&&n.scrollBy({left:-r.x,behavior:a});break}if(p&&m.y!==c.y){const e=n.scrollTop+t.y,i=o===xe.Down&&e<=u.y||o===xe.Up&&e>=f.y;if(i&&!t.x)return void n.scrollTo({top:e,behavior:a});r.y=i?n.scrollTop-e:o===xe.Down?n.scrollTop-u.y:n.scrollTop-f.y,r.y&&n.scrollBy({top:-r.y,behavior:a});break}}this.handleMove(e,_(D(c,this.referenceCoordinates),r))}}}handleMove(e,t){const{onMove:n}=this.props;e.preventDefault(),n(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function Re(e){return Boolean(e&&"distance"in e)}function Ne(e){return Boolean(e&&"delay"in e)}Ee.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=_e,onActivation:o}=t,{active:i}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const t=i.activatorNode.current;return!(t&&e.target!==t||(e.preventDefault(),null==o||o({event:e.nativeEvent}),0))}return!1}}];class je{constructor(e,t,n){var r;void 0===n&&(n=function(e){const{EventTarget:t}=c(e);return e instanceof t?e:m(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:o}=e,{target:i}=o;this.props=e,this.events=t,this.document=m(i),this.documentListeners=new be(this.document),this.listeners=new be(n),this.windowListeners=new be(c(i)),this.initialCoordinates=null!=(r=R(o))?r:$,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(ye.Resize,this.handleCancel),this.windowListeners.add(ye.DragStart,Ce),this.windowListeners.add(ye.VisibilityChange,this.handleCancel),this.windowListeners.add(ye.ContextMenu,Ce),this.documentListeners.add(ye.Keydown,this.handleKeydown),t){if(null!=n&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Ne(t))return this.timeoutId=setTimeout(this.handleStart,t.delay),void this.handlePending(t);if(Re(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:n,onPending:r}=this.props;r(n,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(ye.Click,Se,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ye.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:n,initialCoordinates:r,props:o}=this,{onMove:i,options:{activationConstraint:a}}=o;if(!r)return;const l=null!=(t=R(e))?t:$,s=D(r,l);if(!n&&a){if(Re(a)){if(null!=a.tolerance&&we(s,a.tolerance))return this.handleCancel();if(we(s,a.distance))return this.handleStart()}return Ne(a)&&we(s,a.tolerance)?this.handleCancel():void this.handlePending(a,s)}e.cancelable&&e.preventDefault(),i(l)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===xe.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}const Me={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class ke extends je{constructor(e){const{event:t}=e,n=m(t.target);super(e,Me,n)}}ke.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!(!n.isPrimary||0!==n.button||(null==r||r({event:n}),0))}}];const Ie={move:{name:"mousemove"},end:{name:"mouseup"}};var Te;!function(e){e[e.RightClick=2]="RightClick"}(Te||(Te={})),class extends je{constructor(e){super(e,Ie,m(e.event.target))}}.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button!==Te.RightClick&&(null==r||r({event:n}),!0)}}];const Ae={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};var Le,Fe;(class extends je{constructor(e){super(e,Ae)}static setup(){return window.addEventListener(Ae.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(Ae.move.name,e)};function e(){}}}).activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return!(o.length>1||(null==r||r({event:n}),0))}}],function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"}(Le||(Le={})),function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"}(Fe||(Fe={}));const Oe={x:{[de.Backward]:!1,[de.Forward]:!1},y:{[de.Backward]:!1,[de.Forward]:!1}};var ze,Pe;!function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"}(ze||(ze={})),function(e){e.Optimized="optimized"}(Pe||(Pe={}));const Be=new Map;function $e(e,t){return b(n=>e?n||("function"==typeof t?t(e):e):null,[t,e])}function Ue(e){let{callback:t,disabled:n}=e;const r=p(t),i=(0,o.useMemo)(()=>{if(n||"undefined"==typeof window||void 0===window.ResizeObserver)return;const{ResizeObserver:e}=window;return new e(r)},[n]);return(0,o.useEffect)(()=>()=>null==i?void 0:i.disconnect(),[i]),i}function He(e){return new ge(te(e),e)}function We(e,t,n){void 0===t&&(t=He);const[r,i]=(0,o.useState)(null);function a(){i(r=>{if(!e)return null;var o;if(!1===e.isConnected)return null!=(o=null!=r?r:n)?o:null;const i=t(e);return JSON.stringify(r)===JSON.stringify(i)?r:i})}const l=function(e){let{callback:t,disabled:n}=e;const r=p(t),i=(0,o.useMemo)(()=>{if(n||"undefined"==typeof window||void 0===window.MutationObserver)return;const{MutationObserver:e}=window;return new e(r)},[r,n]);return(0,o.useEffect)(()=>()=>null==i?void 0:i.disconnect(),[i]),i}({callback(t){if(e)for(const n of t){const{type:t,target:r}=n;if("childList"===t&&r instanceof HTMLElement&&r.contains(e)){a();break}}}}),s=Ue({callback:a});return h(()=>{a(),e?(null==s||s.observe(e),null==l||l.observe(document.body,{childList:!0,subtree:!0})):(null==s||s.disconnect(),null==l||l.disconnect())},[e]),r}const Ke=[];function qe(e,t){void 0===t&&(t=[]);const n=(0,o.useRef)(null);return(0,o.useEffect)(()=>{n.current=null},t),(0,o.useEffect)(()=>{const t=e!==$;t&&!n.current&&(n.current=e),!t&&n.current&&(n.current=null)},[e]),n.current?D(e,n.current):$}function Ve(e){return(0,o.useMemo)(()=>e?function(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}(e):null,[e])}const Xe=[];const Qe=[{sensor:ke,options:{}},{sensor:Ee,options:{}}],Ye={current:{}},Je={draggable:{measure:ne},droppable:{measure:ne,strategy:ze.WhileDragging,frequency:Pe.Optimized},dragOverlay:{measure:te}};class Ge extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,n;return null!=(t=null==(n=this.get(e))?void 0:n.node.current)?t:void 0}}const Ze={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ge,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:P},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Je,measureDroppableContainers:P,windowRect:null,measuringScheduled:!1},et={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:P,draggableNodes:new Map,over:null,measureDroppableContainers:P},tt=(0,o.createContext)(et),nt=(0,o.createContext)(Ze);function rt(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ge}}}function ot(e,t){switch(t.type){case z.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case z.DragMove:return null==e.draggable.active?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case z.DragEnd:case z.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case z.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new Ge(e.droppable.containers);return o.set(r,n),{...e,droppable:{...e.droppable,containers:o}}}case z.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const a=new Ge(e.droppable.containers);return a.set(n,{...i,disabled:o}),{...e,droppable:{...e.droppable,containers:a}}}case z.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const i=new Ge(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function it(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:i}=(0,o.useContext)(tt),a=y(r),l=y(null==n?void 0:n.id);return(0,o.useEffect)(()=>{if(!t&&!r&&a&&null!=l){if(!E(a))return;if(document.activeElement===a.target)return;const e=i.get(l);if(!e)return;const{activatorNode:t,node:n}=e;if(!t.current&&!n.current)return;requestAnimationFrame(()=>{for(const e of[t.current,n.current]){if(!e)continue;const t=M(e);if(t){t.focus();break}}})}},[r,t,i,l,a]),null}const at=(0,o.createContext)({...$,scaleX:1,scaleY:1});var lt;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(lt||(lt={}));const st=(0,o.memo)(function(e){var t,n,r,s;let{id:d,accessibility:u,autoScroll:v=!0,children:m,sensors:p=Qe,collisionDetection:x=Y,measuring:S,modifiers:D,...E}=e;const N=(0,o.useReducer)(ot,void 0,rt),[j,M]=N,[k,I]=function(){const[e]=(0,o.useState)(()=>new Set),t=(0,o.useCallback)(t=>(e.add(t),()=>e.delete(t)),[e]);return[(0,o.useCallback)(t=>{let{type:n,event:r}=t;e.forEach(e=>{var t;return null==(t=e[n])?void 0:t.call(e,r)})},[e]),t]}(),[T,L]=(0,o.useState)(lt.Uninitialized),F=T===lt.Initialized,{draggable:{active:P,nodes:B,translate:U},droppable:{containers:H}}=j,W=null!=P?B.get(P):null,K=(0,o.useRef)({initial:null,translated:null}),V=(0,o.useMemo)(()=>{var e;return null!=P?{id:P,data:null!=(e=null==W?void 0:W.data)?e:Ye,rect:K}:null},[P,W]),X=(0,o.useRef)(null),[Q,G]=(0,o.useState)(null),[ee,ne]=(0,o.useState)(null),ae=g(E,Object.values(E)),le=C("DndDescribedBy",d),ue=(0,o.useMemo)(()=>H.getEnabled(),[H]),fe=(me=S,(0,o.useMemo)(()=>({draggable:{...Je.draggable,...null==me?void 0:me.draggable},droppable:{...Je.droppable,...null==me?void 0:me.droppable},dragOverlay:{...Je.dragOverlay,...null==me?void 0:me.dragOverlay}}),[null==me?void 0:me.draggable,null==me?void 0:me.droppable,null==me?void 0:me.dragOverlay]));var me;const{droppableRects:pe,measureDroppableContainers:be,measuringScheduled:we}=function(e,t){let{dragging:n,dependencies:r,config:i}=t;const[a,l]=(0,o.useState)(null),{frequency:s,measure:d,strategy:c}=i,u=(0,o.useRef)(e),f=function(){switch(c){case ze.Always:return!1;case ze.BeforeDragging:return n;default:return!n}}(),v=g(f),m=(0,o.useCallback)(function(e){void 0===e&&(e=[]),v.current||l(t=>null===t?e:t.concat(e.filter(e=>!t.includes(e))))},[v]),h=(0,o.useRef)(null),p=b(t=>{if(f&&!n)return Be;if(!t||t===Be||u.current!==e||null!=a){const t=new Map;for(let n of e){if(!n)continue;if(a&&a.length>0&&!a.includes(n.id)&&n.rect.current){t.set(n.id,n.rect.current);continue}const e=n.node.current,r=e?new ge(d(e),e):null;n.rect.current=r,r&&t.set(n.id,r)}return t}return t},[e,a,n,f,d]);return(0,o.useEffect)(()=>{u.current=e},[e]),(0,o.useEffect)(()=>{f||m()},[n,f]),(0,o.useEffect)(()=>{a&&a.length>0&&l(null)},[JSON.stringify(a)]),(0,o.useEffect)(()=>{f||"number"!=typeof s||null!==h.current||(h.current=setTimeout(()=>{m(),h.current=null},s))},[s,f,m,...r]),{droppableRects:p,measureDroppableContainers:m,measuringScheduled:null!=a}}(ue,{dragging:F,dependencies:[U.x,U.y],config:fe.droppable}),ye=function(e,t){const n=null!=t?e.get(t):void 0,r=n?n.node.current:null;return b(e=>{var n;return null==t?null:null!=(n=null!=r?r:e)?n:null},[r,t])}(B,P),xe=(0,o.useMemo)(()=>ee?R(ee):null,[ee]),Ce=function(){const e=!1===(null==Q?void 0:Q.autoScrollEnabled),t="object"==typeof v?!1===v.enabled:!1===v,n=F&&!e&&!t;return"object"==typeof v?{...v,enabled:n}:{enabled:n}}(),Se=function(e,t){return $e(e,t)}(ye,fe.draggable.measure);!function(e){let{activeNode:t,measure:n,initialRect:r,config:i=!0}=e;const a=(0,o.useRef)(!1),{x:l,y:s}="boolean"==typeof i?{x:i,y:i}:i;h(()=>{if(!l&&!s||!t)return void(a.current=!1);if(a.current||!r)return;const e=null==t?void 0:t.node.current;if(!e||!1===e.isConnected)return;const o=J(n(e),r);if(l||(o.x=0),s||(o.y=0),a.current=!0,Math.abs(o.x)>0||Math.abs(o.y)>0){const t=oe(e);t&&t.scrollBy({top:o.y,left:o.x})}},[t,l,s,r,n])}({activeNode:null!=P?B.get(P):null,config:Ce.layoutShiftCompensation,initialRect:Se,measure:fe.draggable.measure});const _e=We(ye,fe.draggable.measure,Se),De=We(ye?ye.parentElement:null),Ee=(0,o.useRef)({activatorEvent:null,active:null,activeNode:ye,collisionRect:null,collisions:null,droppableRects:pe,draggableNodes:B,draggingNode:null,draggingNodeRect:null,droppableContainers:H,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Re=H.getNodeFor(null==(t=Ee.current.over)?void 0:t.id),Ne=function(e){let{measure:t}=e;const[n,r]=(0,o.useState)(null),i=Ue({callback:(0,o.useCallback)(e=>{for(const{target:n}of e)if(f(n)){r(e=>{const r=t(n);return e?{...e,width:r.width,height:r.height}:r});break}},[t])}),a=(0,o.useCallback)(e=>{const n=function(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return f(t)?t:e}(e);null==i||i.disconnect(),n&&(null==i||i.observe(n)),r(n?t(n):null)},[t,i]),[l,s]=w(a);return(0,o.useMemo)(()=>({nodeRef:l,rect:n,setRef:s}),[n,l,s])}({measure:fe.dragOverlay.measure}),je=null!=(n=Ne.nodeRef.current)?n:ye,Me=F?null!=(r=Ne.rect)?r:_e:null,ke=Boolean(Ne.nodeRef.current&&Ne.rect),Ie=J(Te=ke?null:_e,$e(Te));var Te;const Ae=Ve(je?c(je):null),Pe=function(e){const t=(0,o.useRef)(e),n=b(n=>e?n&&n!==Ke&&e&&t.current&&e.parentNode===t.current.parentNode?n:re(e):Ke,[e]);return(0,o.useEffect)(()=>{t.current=e},[e]),n}(F?null!=Re?Re:ye:null),He=function(e,t){void 0===t&&(t=te);const[n]=e,r=Ve(n?c(n):null),[i,a]=(0,o.useState)(Xe);function l(){a(()=>e.length?e.map(e=>ce(e)?r:new ge(t(e),e)):Xe)}const s=Ue({callback:l});return h(()=>{null==s||s.disconnect(),l(),e.forEach(e=>null==s?void 0:s.observe(e))},[e]),i}(Pe),Ge=function(e,t){let{transform:n,...r}=t;return null!=e&&e.length?e.reduce((e,t)=>t({transform:e,...r}),n):n}(D,{transform:{x:U.x-Ie.x,y:U.y-Ie.y,scaleX:1,scaleY:1},activatorEvent:ee,active:V,activeNodeRect:_e,containerNodeRect:De,draggingNodeRect:Me,over:Ee.current.over,overlayNodeRect:Ne.rect,scrollableAncestors:Pe,scrollableAncestorRects:He,windowRect:Ae}),Ze=xe?_(xe,U):null,et=function(e){const[t,n]=(0,o.useState)(null),r=(0,o.useRef)(e),i=(0,o.useCallback)(e=>{const t=ie(e.target);t&&n(e=>e?(e.set(t,se(t)),new Map(e)):null)},[]);return(0,o.useEffect)(()=>{const t=r.current;if(e!==t){o(t);const a=e.map(e=>{const t=ie(e);return t?(t.addEventListener("scroll",i,{passive:!0}),[t,se(t)]):null}).filter(e=>null!=e);n(a.length?new Map(a):null),r.current=e}return()=>{o(e),o(t)};function o(e){e.forEach(e=>{const t=ie(e);null==t||t.removeEventListener("scroll",i)})}},[i,e]),(0,o.useMemo)(()=>e.length?t?Array.from(t.values()).reduce((e,t)=>_(e,t),$):he(e):$,[e,t])}(Pe),st=qe(et),dt=qe(et,[_e]),ct=_(Ge,st),ut=Me?Z(Me,Ge):null,ft=V&&ut?x({active:V,collisionRect:ut,droppableRects:pe,droppableContainers:ue,pointerCoordinates:Ze}):null,vt=q(ft,"id"),[mt,ht]=(0,o.useState)(null),pt=function(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}(ke?Ge:_(Ge,dt),null!=(s=null==mt?void 0:mt.rect)?s:null,_e),gt=(0,o.useRef)(null),bt=(0,o.useCallback)((e,t)=>{let{sensor:n,options:r}=t;if(null==X.current)return;const o=B.get(X.current);if(!o)return;const i=e.nativeEvent,l=new n({active:X.current,activeNode:o,event:i,options:r,context:Ee,onAbort(e){if(!B.get(e))return;const{onDragAbort:t}=ae.current,n={id:e};null==t||t(n),k({type:"onDragAbort",event:n})},onPending(e,t,n,r){if(!B.get(e))return;const{onDragPending:o}=ae.current,i={id:e,constraint:t,initialCoordinates:n,offset:r};null==o||o(i),k({type:"onDragPending",event:i})},onStart(e){const t=X.current;if(null==t)return;const n=B.get(t);if(!n)return;const{onDragStart:r}=ae.current,o={activatorEvent:i,active:{id:t,data:n.data,rect:K}};(0,a.unstable_batchedUpdates)(()=>{null==r||r(o),L(lt.Initializing),M({type:z.DragStart,initialCoordinates:e,active:t}),k({type:"onDragStart",event:o}),G(gt.current),ne(i)})},onMove(e){M({type:z.DragMove,coordinates:e})},onEnd:s(z.DragEnd),onCancel:s(z.DragCancel)});function s(e){return async function(){const{active:t,collisions:n,over:r,scrollAdjustedTranslate:o}=Ee.current;let l=null;if(t&&o){const{cancelDrop:a}=ae.current;l={activatorEvent:i,active:t,collisions:n,delta:o,over:r},e===z.DragEnd&&"function"==typeof a&&await Promise.resolve(a(l))&&(e=z.DragCancel)}X.current=null,(0,a.unstable_batchedUpdates)(()=>{M({type:e}),L(lt.Uninitialized),ht(null),G(null),ne(null),gt.current=null;const t=e===z.DragEnd?"onDragEnd":"onDragCancel";if(l){const e=ae.current[t];null==e||e(l),k({type:t,event:l})}})}}gt.current=l},[B]),wt=(0,o.useCallback)((e,t)=>(n,r)=>{const o=n.nativeEvent,i=B.get(r);if(null!==X.current||!i||o.dndKit||o.defaultPrevented)return;const a={active:i};!0===e(n,t.options,a)&&(o.dndKit={capturedBy:t.sensor},X.current=r,bt(n,t))},[B,bt]),yt=function(e,t){return(0,o.useMemo)(()=>e.reduce((e,n)=>{const{sensor:r}=n;return[...e,...r.activators.map(e=>({eventName:e.eventName,handler:t(e.handler,n)}))]},[]),[e,t])}(p,wt);!function(e){(0,o.useEffect)(()=>{if(!l)return;const t=e.map(e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()});return()=>{for(const e of t)null==e||e()}},e.map(e=>{let{sensor:t}=e;return t}))}(p),h(()=>{_e&&T===lt.Initializing&&L(lt.Initialized)},[_e,T]),(0,o.useEffect)(()=>{const{onDragMove:e}=ae.current,{active:t,activatorEvent:n,collisions:r,over:o}=Ee.current;if(!t||!n)return;const i={active:t,activatorEvent:n,collisions:r,delta:{x:ct.x,y:ct.y},over:o};(0,a.unstable_batchedUpdates)(()=>{null==e||e(i),k({type:"onDragMove",event:i})})},[ct.x,ct.y]),(0,o.useEffect)(()=>{const{active:e,activatorEvent:t,collisions:n,droppableContainers:r,scrollAdjustedTranslate:o}=Ee.current;if(!e||null==X.current||!t||!o)return;const{onDragOver:i}=ae.current,l=r.get(vt),s=l&&l.rect.current?{id:l.id,rect:l.rect.current,data:l.data,disabled:l.disabled}:null,d={active:e,activatorEvent:t,collisions:n,delta:{x:o.x,y:o.y},over:s};(0,a.unstable_batchedUpdates)(()=>{ht(s),null==i||i(d),k({type:"onDragOver",event:d})})},[vt]),h(()=>{Ee.current={activatorEvent:ee,active:V,activeNode:ye,collisionRect:ut,collisions:ft,droppableRects:pe,draggableNodes:B,draggingNode:je,draggingNodeRect:Me,droppableContainers:H,over:mt,scrollableAncestors:Pe,scrollAdjustedTranslate:ct},K.current={initial:Me,translated:ut}},[V,ye,ft,ut,B,je,Me,pe,H,mt,Pe,ct]),function(e){let{acceleration:t,activator:n=Le.Pointer,canScroll:r,draggingRect:i,enabled:a,interval:l=5,order:s=Fe.TreeOrder,pointerCoordinates:d,scrollableAncestors:c,scrollableAncestorRects:u,delta:f,threshold:v}=e;const m=function(e){let{delta:t,disabled:n}=e;const r=y(t);return b(e=>{if(n||!r||!e)return Oe;const o=Math.sign(t.x-r.x),i=Math.sign(t.y-r.y);return{x:{[de.Backward]:e.x[de.Backward]||-1===o,[de.Forward]:e.x[de.Forward]||1===o},y:{[de.Backward]:e.y[de.Backward]||-1===i,[de.Forward]:e.y[de.Forward]||1===i}}},[n,t,r])}({delta:f,disabled:!a}),[h,p]=function(){const e=(0,o.useRef)(null);return[(0,o.useCallback)((t,n)=>{e.current=setInterval(t,n)},[]),(0,o.useCallback)(()=>{null!==e.current&&(clearInterval(e.current),e.current=null)},[])]}(),g=(0,o.useRef)({x:0,y:0}),w=(0,o.useRef)({x:0,y:0}),x=(0,o.useMemo)(()=>{switch(n){case Le.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case Le.DraggableRect:return i}},[n,i,d]),C=(0,o.useRef)(null),S=(0,o.useCallback)(()=>{const e=C.current;if(!e)return;const t=g.current.x*w.current.x,n=g.current.y*w.current.y;e.scrollBy(t,n)},[]),_=(0,o.useMemo)(()=>s===Fe.TreeOrder?[...c].reverse():c,[s,c]);(0,o.useEffect)(()=>{if(a&&c.length&&x){for(const e of _){if(!1===(null==r?void 0:r(e)))continue;const n=c.indexOf(e),o=u[n];if(!o)continue;const{direction:i,speed:a}=ve(e,o,x,t,v);for(const e of["x","y"])m[e][i[e]]||(a[e]=0,i[e]=0);if(a.x>0||a.y>0)return p(),C.current=e,h(S,l),g.current=a,void(w.current=i)}g.current={x:0,y:0},w.current={x:0,y:0},p()}else p()},[t,S,r,p,a,l,JSON.stringify(x),JSON.stringify(m),h,c,_,u,JSON.stringify(v)])}({...Ce,delta:U,draggingRect:ut,pointerCoordinates:Ze,scrollableAncestors:Pe,scrollableAncestorRects:He});const xt=(0,o.useMemo)(()=>({active:V,activeNode:ye,activeNodeRect:_e,activatorEvent:ee,collisions:ft,containerNodeRect:De,dragOverlay:Ne,draggableNodes:B,droppableContainers:H,droppableRects:pe,over:mt,measureDroppableContainers:be,scrollableAncestors:Pe,scrollableAncestorRects:He,measuringConfiguration:fe,measuringScheduled:we,windowRect:Ae}),[V,ye,_e,ee,ft,De,Ne,B,H,pe,mt,be,Pe,He,fe,we,Ae]),Ct=(0,o.useMemo)(()=>({activatorEvent:ee,activators:yt,active:V,activeNodeRect:_e,ariaDescribedById:{draggable:le},dispatch:M,draggableNodes:B,over:mt,measureDroppableContainers:be}),[ee,yt,V,_e,M,le,B,mt,be]);return i().createElement(A.Provider,{value:I},i().createElement(tt.Provider,{value:Ct},i().createElement(nt.Provider,{value:xt},i().createElement(at.Provider,{value:pt},m)),i().createElement(it,{disabled:!1===(null==u?void 0:u.restoreFocus)})),i().createElement(O,{...u,hiddenTextDescribedById:le}))}),dt=(0,o.createContext)(null),ct="button";const ut={timeout:25};function ft(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function vt(e,t){return e.reduce((e,n,r)=>{const o=t.get(n);return o&&(e[r]=o),e},Array(e.length))}function mt(e){return null!==e&&e>=0}const ht=e=>{let{rects:t,activeIndex:n,overIndex:r,index:o}=e;const i=ft(t,r,n),a=t[o],l=i[o];return l&&a?{x:l.left-a.left,y:l.top-a.top,scaleX:l.width/a.width,scaleY:l.height/a.height}:null},pt={scaleX:1,scaleY:1},gt=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:o,rects:i,overIndex:a}=e;const l=null!=(t=i[n])?t:r;if(!l)return null;if(o===n){const e=i[a];return e?{x:0,y:n<a?e.top+e.height-(l.top+l.height):e.top-l.top,...pt}:null}const s=function(e,t,n){const r=e[t],o=e[t-1],i=e[t+1];return r?n<t?o?r.top-(o.top+o.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):o?r.top-(o.top+o.height):0:0}(i,o,n);return o>n&&o<=a?{x:0,y:-l.height-s,...pt}:o<n&&o>=a?{x:0,y:l.height+s,...pt}:{x:0,y:0,...pt}},bt="Sortable",wt=i().createContext({activeIndex:-1,containerId:bt,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:ht,disabled:{draggable:!1,droppable:!1}});function yt(e){let{children:t,id:n,items:r,strategy:a=ht,disabled:l=!1}=e;const{active:s,dragOverlay:d,droppableRects:c,over:u,measureDroppableContainers:f}=(0,o.useContext)(nt),v=C(bt,n),m=Boolean(null!==d.rect),p=(0,o.useMemo)(()=>r.map(e=>"object"==typeof e&&"id"in e?e.id:e),[r]),g=null!=s,b=s?p.indexOf(s.id):-1,w=u?p.indexOf(u.id):-1,y=(0,o.useRef)(p),x=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(p,y.current),S=-1!==w&&-1===b||x,_=function(e){return"boolean"==typeof e?{draggable:e,droppable:e}:e}(l);h(()=>{x&&g&&f(p)},[x,p,g,f]),(0,o.useEffect)(()=>{y.current=p},[p]);const D=(0,o.useMemo)(()=>({activeIndex:b,containerId:v,disabled:_,disableTransforms:S,items:p,overIndex:w,useDragOverlay:m,sortedRects:vt(p,c),strategy:a}),[b,v,_.draggable,_.droppable,S,p,w,c,m,a]);return i().createElement(wt.Provider,{value:D},t)}const xt=e=>{let{id:t,items:n,activeIndex:r,overIndex:o}=e;return ft(n,r,o).indexOf(t)},Ct=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:o,items:i,newIndex:a,previousItems:l,previousContainerId:s,transition:d}=e;return!(!d||!r||l!==i&&o===a||!n&&(a===o||t!==s))},St={duration:200,easing:"ease"},_t="transform",Dt=N.Transition.toString({property:_t,duration:0,easing:"linear"}),Et={roleDescription:"sortable"};function Rt(e){let{animateLayoutChanges:t=Ct,attributes:n,disabled:r,data:i,getNewIndex:a=xt,id:l,strategy:s,resizeObserverConfig:d,transition:c=St}=e;const{items:u,containerId:f,activeIndex:v,disabled:m,disableTransforms:p,sortedRects:b,overIndex:y,useDragOverlay:x,strategy:S}=(0,o.useContext)(wt),_=function(e,t){var n,r;return"boolean"==typeof e?{draggable:e,droppable:!1}:{draggable:null!=(n=null==e?void 0:e.draggable)?n:t.draggable,droppable:null!=(r=null==e?void 0:e.droppable)?r:t.droppable}}(r,m),D=u.indexOf(l),R=(0,o.useMemo)(()=>({sortable:{containerId:f,index:D,items:u},...i}),[f,i,D,u]),j=(0,o.useMemo)(()=>u.slice(u.indexOf(l)),[u,l]),{rect:M,node:k,isOver:I,setNodeRef:T}=function(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:i}=e;const a=C("Droppable"),{active:l,dispatch:s,over:d,measureDroppableContainers:c}=(0,o.useContext)(tt),u=(0,o.useRef)({disabled:n}),f=(0,o.useRef)(!1),v=(0,o.useRef)(null),m=(0,o.useRef)(null),{disabled:h,updateMeasurementsFor:p,timeout:b}={...ut,...i},y=g(null!=p?p:r),x=Ue({callback:(0,o.useCallback)(()=>{f.current?(null!=m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{c(Array.isArray(y.current)?y.current:[y.current]),m.current=null},b)):f.current=!0},[b]),disabled:h||!l}),S=(0,o.useCallback)((e,t)=>{x&&(t&&(x.unobserve(t),f.current=!1),e&&x.observe(e))},[x]),[_,D]=w(S),E=g(t);return(0,o.useEffect)(()=>{x&&_.current&&(x.disconnect(),f.current=!1,x.observe(_.current))},[_,x]),(0,o.useEffect)(()=>(s({type:z.RegisterDroppable,element:{id:r,key:a,disabled:n,node:_,rect:v,data:E}}),()=>s({type:z.UnregisterDroppable,key:a,id:r})),[r]),(0,o.useEffect)(()=>{n!==u.current.disabled&&(s({type:z.SetDroppableDisabled,id:r,key:a,disabled:n}),u.current.disabled=n)},[r,a,n,s]),{active:l,rect:v,isOver:(null==d?void 0:d.id)===r,node:_,over:d,setNodeRef:D}}({id:l,data:R,disabled:_.droppable,resizeObserverConfig:{updateMeasurementsFor:j,...d}}),{active:A,activatorEvent:L,activeNodeRect:F,attributes:O,setNodeRef:P,listeners:B,isDragging:$,over:U,setActivatorNodeRef:H,transform:W}=function(e){let{id:t,data:n,disabled:r=!1,attributes:i}=e;const a=C("Draggable"),{activators:l,activatorEvent:s,active:d,activeNodeRect:c,ariaDescribedById:u,draggableNodes:f,over:v}=(0,o.useContext)(tt),{role:m=ct,roleDescription:p="draggable",tabIndex:b=0}=null!=i?i:{},y=(null==d?void 0:d.id)===t,x=(0,o.useContext)(y?at:dt),[S,_]=w(),[D,E]=w(),R=function(e,t){return(0,o.useMemo)(()=>e.reduce((e,n)=>{let{eventName:r,handler:o}=n;return e[r]=e=>{o(e,t)},e},{}),[e,t])}(l,t),N=g(n);return h(()=>(f.set(t,{id:t,key:a,node:S,activatorNode:D,data:N}),()=>{const e=f.get(t);e&&e.key===a&&f.delete(t)}),[f,t]),{active:d,activatorEvent:s,activeNodeRect:c,attributes:(0,o.useMemo)(()=>({role:m,tabIndex:b,"aria-disabled":r,"aria-pressed":!(!y||m!==ct)||void 0,"aria-roledescription":p,"aria-describedby":u.draggable}),[r,m,b,y,p,u.draggable]),isDragging:y,listeners:r?void 0:R,node:S,over:v,setNodeRef:_,setActivatorNodeRef:E,transform:x}}({id:l,data:R,attributes:{...Et,...n},disabled:_.draggable}),K=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,o.useMemo)(()=>e=>{t.forEach(t=>t(e))},t)}(T,P),q=Boolean(A),V=q&&!p&&mt(v)&&mt(y),X=!x&&$,Q=X&&V?W:null,Y=V?null!=Q?Q:(null!=s?s:S)({rects:b,activeNodeRect:F,activeIndex:v,overIndex:y,index:D}):null,J=mt(v)&&mt(y)?a({id:l,items:u,activeIndex:v,overIndex:y}):D,G=null==A?void 0:A.id,Z=(0,o.useRef)({activeId:G,items:u,newIndex:J,containerId:f}),ee=u!==Z.current.items,ne=t({active:A,containerId:f,isDragging:$,isSorting:q,id:l,index:D,items:u,newIndex:Z.current.newIndex,previousItems:Z.current.items,previousContainerId:Z.current.containerId,transition:c,wasDragging:null!=Z.current.activeId}),re=function(e){let{disabled:t,index:n,node:r,rect:i}=e;const[a,l]=(0,o.useState)(null),s=(0,o.useRef)(n);return h(()=>{if(!t&&n!==s.current&&r.current){const e=i.current;if(e){const t=te(r.current,{ignoreTransform:!0}),n={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(n.x||n.y)&&l(n)}}n!==s.current&&(s.current=n)},[t,n,r,i]),(0,o.useEffect)(()=>{a&&l(null)},[a]),a}({disabled:!ne,index:D,node:k,rect:M});return(0,o.useEffect)(()=>{q&&Z.current.newIndex!==J&&(Z.current.newIndex=J),f!==Z.current.containerId&&(Z.current.containerId=f),u!==Z.current.items&&(Z.current.items=u)},[q,J,f,u]),(0,o.useEffect)(()=>{if(G===Z.current.activeId)return;if(G&&!Z.current.activeId)return void(Z.current.activeId=G);const e=setTimeout(()=>{Z.current.activeId=G},50);return()=>clearTimeout(e)},[G]),{active:A,activeIndex:v,attributes:O,data:R,rect:M,index:D,newIndex:J,items:u,isOver:I,isSorting:q,isDragging:$,listeners:B,node:k,overIndex:y,over:U,setNodeRef:K,setActivatorNodeRef:H,setDroppableNodeRef:T,setDraggableNodeRef:P,transform:null!=re?re:Y,transition:re||ee&&Z.current.newIndex===D?Dt:X&&!E(L)||!c?void 0:q||ne?N.Transition.toString({...c,property:_t}):void 0}}function Nt(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&"object"==typeof t.sortable&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const jt=[xe.Down,xe.Right,xe.Up,xe.Left],Mt=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:o,droppableContainers:i,over:a,scrollableAncestors:l}}=t;if(jt.includes(e.code)){if(e.preventDefault(),!n||!r)return;const t=[];i.getEnabled().forEach(n=>{if(!n||null!=n&&n.disabled)return;const i=o.get(n.id);if(i)switch(e.code){case xe.Down:r.top<i.top&&t.push(n);break;case xe.Up:r.top>i.top&&t.push(n);break;case xe.Left:r.left>i.left&&t.push(n);break;case xe.Right:r.left<i.left&&t.push(n)}});const c=(e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=K(t),i=[];for(const e of r){const{id:t}=e,r=n.get(t);if(r){const n=K(r),a=o.reduce((e,t,r)=>e+U(n[r],t),0),l=Number((a/4).toFixed(4));i.push({id:t,data:{droppableContainer:e,value:l}})}}return i.sort(H)})({active:n,collisionRect:r,droppableRects:o,droppableContainers:t,pointerCoordinates:null});let u=q(c,"id");if(u===(null==a?void 0:a.id)&&c.length>1&&(u=c[1].id),null!=u){const e=i.get(n.id),t=i.get(u),a=t?o.get(t.id):null,c=null==t?void 0:t.node.current;if(c&&a&&e&&t){const n=re(c).some((e,t)=>l[t]!==e),o=kt(e,t),i=(d=t,!(!Nt(s=e)||!Nt(d))&&!!kt(s,d)&&s.data.current.sortable.index<d.data.current.sortable.index),u=n||!o?{x:0,y:0}:{x:i?r.width-a.width:0,y:i?r.height-a.height:0},f={x:a.left,y:a.top};return u.x&&u.y?f:D(f,u)}}}var s,d};function kt(e,t){return!(!Nt(e)||!Nt(t))&&e.data.current.sortable.containerId===t.data.current.sortable.containerId}const It=window.wp.apiFetch;var Tt=e.n(It);const At=window.ReactJSXRuntime;function Lt({expanded:e}){return(0,At.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e?(0,At.jsx)("polyline",{points:"6 9 12 15 18 9"}):(0,At.jsx)("polyline",{points:"9 6 15 12 9 18"})})}function Ft({folder:e,selectedId:n,onSelect:o,level:i=0,parentId:a=null,renderWrapper:l,enableKeyboardNav:s=!1,enableAutoExpand:d=!1,enableAria:c=!1}){const u=e=>!(!e.children||0===e.children.length)&&e.children.some(e=>e.id===n||u(e)),f=d&&u(e),[v,m]=(0,t.useState)(f),h=v||f,p=e.children&&e.children.length>0,g=n===e.id;(0,t.useEffect)(()=>{f&&!v&&m(!0)},[f,v]);const b=(0,At.jsxs)("button",{type:"button",className:"vmf-folder-button "+(g?"is-selected":""),style:{paddingLeft:16*i+8+"px"},onClick:()=>o(e.id),onKeyDown:s?t=>{s&&("ArrowRight"===t.key&&p&&!h?(t.preventDefault(),m(!0)):"ArrowLeft"===t.key?(t.preventDefault(),p&&h?m(!1):null!==a&&o(a)):"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),o(e.id)))}:void 0,"aria-current":g?"true":void 0,title:e.name,children:[p&&(0,At.jsx)("span",{className:"vmf-folder-toggle",onClick:t=>{t.stopPropagation(),h&&u(e)&&o(e.id),m(!h)},onKeyDown:s?t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),t.stopPropagation(),h&&u(e)&&o(e.id),m(!h))}:void 0,role:s?"button":void 0,tabIndex:s?0:void 0,"aria-label":h?(0,r.__)("Collapse","virtual-media-folders"):(0,r.__)("Expand","virtual-media-folders"),children:(0,At.jsx)(Lt,{expanded:h})}),(0,At.jsx)("span",{className:"vmf-folder-name",children:e.name}),"number"==typeof e.count&&(0,At.jsxs)("span",{className:"vmf-folder-count","aria-label":c?`${e.count} ${(0,r.__)("items","virtual-media-folders")}`:void 0,children:["(",e.count,")"]})]}),w=l?l({folderId:e.id,children:b}):b,y=c?{role:"treeitem","aria-expanded":p?h:void 0,"aria-selected":g}:{};return(0,At.jsxs)("li",{className:"vmf-folder-item",...y,children:[w,p&&h&&(0,At.jsx)("ul",{className:"vmf-folder-children",role:c?"group":void 0,children:e.children.map(t=>(0,At.jsx)(Ft,{folder:t,selectedId:n,onSelect:o,level:i+1,parentId:e.id,renderWrapper:l,enableKeyboardNav:s,enableAutoExpand:d,enableAria:c},t.id))})]})}function Ot({folders:e,selectedId:t,onSelect:n,uncategorizedCount:o,showAllMedia:i=!0,showUncategorized:a=!0,loading:l,renderWrapper:s,renderUncategorizedWrapper:d,renderHeader:c,enableKeyboardNav:u=!1,enableAutoExpand:f=!1,enableAria:v=!1,className:m="",loadingText:h}){if(l){const e=v?"vmf-folder-tree":"vmf-folder-sidebar";return(0,At.jsx)("div",{className:`${e} ${e}--loading ${m}`,"aria-label":v?(0,r.__)("Media folders","virtual-media-folders"):void 0,children:(0,At.jsx)("p",{"aria-live":v?"polite":void 0,children:h||(0,r.__)("Loadingâ€¦","virtual-media-folders")})})}const p=(0,At.jsx)("button",{type:"button",className:"vmf-folder-button "+(null===t?"is-selected":""),onClick:()=>n(null),"aria-current":null===t?"true":void 0,children:(0,At.jsx)("span",{className:"vmf-folder-name",children:(0,r.__)("All Media","virtual-media-folders")})}),g=(0,At.jsxs)("button",{type:"button",className:"vmf-folder-button "+("uncategorized"===t?"is-selected":""),onClick:()=>n("uncategorized"),"aria-current":"uncategorized"===t?"true":void 0,children:[(0,At.jsx)("span",{className:"vmf-folder-name",children:(0,r.__)("Uncategorized","virtual-media-folders")}),(0,At.jsxs)("span",{className:"vmf-folder-count","aria-label":v?`${o} ${(0,r.__)("items","virtual-media-folders")}`:void 0,children:["(",o,")"]})]}),b=d?d({children:g}):g,w=v?"nav":"div",y=v?"vmf-folder-tree":"vmf-folder-sidebar";return(0,At.jsxs)(w,{className:`${y} ${m}`,"aria-label":v?(0,r.__)("Media folders","virtual-media-folders"):void 0,children:[c&&c(),(0,At.jsxs)("ul",{className:"vmf-folder-list",role:v?"tree":void 0,"aria-label":v?(0,r.__)("Folder tree","virtual-media-folders"):void 0,children:[i&&(0,At.jsx)("li",{className:"vmf-folder-item",role:v?"treeitem":void 0,"aria-selected":v?null===t:void 0,children:p}),a&&(0,At.jsx)("li",{className:"vmf-folder-item",role:v?"treeitem":void 0,"aria-selected":v?"uncategorized"===t:void 0,children:b}),e.map(e=>(0,At.jsx)(Ft,{folder:e,selectedId:t,onSelect:n,renderWrapper:s,enableKeyboardNav:u,enableAutoExpand:f,enableAria:v},e.id))]})]})}function zt({folderId:e,children:n,className:o=""}){const[i,a]=(0,t.useState)(!1),l=(0,t.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),a(!0)},[]),s=(0,t.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),a(!1)},[]),d=(0,t.useCallback)(t=>{t.preventDefault(),t.stopPropagation(),a(!1);try{const n=t.dataTransfer.getData("text/plain");if(!n)return;const r=JSON.parse(n);if(r.mediaId&&window.vmfMoveToFolder){window.vmfMoveToFolder(r.mediaId,e);const{jumpToFolderAfterMove:t=!1}=window.vmfData||{};t&&window.vmfSelectFolder&&setTimeout(()=>{window.vmfSelectFolder(e)},200)}}catch(e){}},[e]);return(0,At.jsxs)("div",{className:`vmf-droppable-folder ${o} ${i?"is-over":""}`,onDragOver:l,onDragEnter:l,onDragLeave:s,onDrop:d,children:[n,i&&(0,At.jsx)("span",{className:"screen-reader-text",children:(0,r.__)("Drop here to move media to this folder","virtual-media-folders")})]})}function Pt({id:e,children:t,disabled:n=!1}){const{attributes:r,listeners:o,setNodeRef:i,transform:a,transition:l,isDragging:s}=Rt({id:e,disabled:n,data:{type:"folder",folderId:e}}),d={transform:N.Transform.toString(a),transition:l,opacity:s?.5:1,zIndex:s?100:void 0};return n?t:(0,At.jsx)("div",{ref:i,style:d,className:"vmf-sortable-folder "+(s?"is-dragging":""),...r,children:(0,At.jsxs)("div",{className:"vmf-sortable-folder__row",children:[(0,At.jsx)("span",{className:"vmf-sortable-folder__grip",...o,"aria-label":"Drag to reorder",children:"â‹®â‹®"}),(0,At.jsx)("div",{className:"vmf-sortable-folder__content",children:t})]})})}(0,t.createContext)(null);const Bt=window.wp.primitives;var $t=(0,At.jsx)(Bt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,At.jsx)(Bt.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})}),Ut=(0,At.jsx)(Bt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,At.jsx)(Bt.Path,{d:"m19 7-3-3-8.5 8.5-1 4 4-1L19 7Zm-7 11.5H5V20h7v-1.5Z"})}),Ht=(0,At.jsx)(Bt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,At.jsx)(Bt.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M12 5.5A2.25 2.25 0 0 0 9.878 7h4.244A2.251 2.251 0 0 0 12 5.5ZM12 4a3.751 3.751 0 0 0-3.675 3H5v1.5h1.27l.818 8.997a2.75 2.75 0 0 0 2.739 2.501h4.347a2.75 2.75 0 0 0 2.738-2.5L17.73 8.5H19V7h-3.325A3.751 3.751 0 0 0 12 4Zm4.224 4.5H7.776l.806 8.861a1.25 1.25 0 0 0 1.245 1.137h4.347a1.25 1.25 0 0 0 1.245-1.137l.805-8.861Z"})});function Wt({folders:e=[],selectedId:o,onRefresh:i,onDelete:a}){const[l,s]=(0,t.useState)(!1),[d,c]=(0,t.useState)(!1),[u,f]=(0,t.useState)(!1),[v,m]=(0,t.useState)(""),[h,p]=(0,t.useState)(0),[g,b]=(0,t.useState)(""),[w,y]=(0,t.useState)(0),[x,C]=(0,t.useState)(!1),[S,_]=(0,t.useState)(""),D=e.find(e=>e.id===o);function E(e,t=0,n=0,r=null){let o=[];const i=e.filter(e=>e.parent===t);for(const t of i){if(null!==r&&t.id===r)continue;const i=n>0?"â€” ".repeat(n):"";o.push({label:i+t.name,value:String(t.id)}),o=o.concat(E(e,t.id,n+1,r))}return o}function R(e,t="success"){const n=document.createElement("div");n.className=`notice notice-${t} vmf-notice is-dismissible`,n.innerHTML=`<p>${e}</p>`,n.style.cssText="position: fixed; top: 40px; right: 20px; z-index: 100000; max-width: 300px;",document.body.appendChild(n),setTimeout(()=>n.remove(),3e3)}const N=o&&"number"==typeof o;return(0,At.jsxs)("div",{className:"vmf-folder-manager",onClick:e=>e.stopPropagation(),children:[(0,At.jsxs)("div",{className:"vmf-folder-manager-buttons",children:[(0,At.jsx)(n.Button,{icon:$t,"aria-label":(0,r.__)("Create Folder","virtual-media-folders"),onClick:t=>{t.stopPropagation(),_("");const n=e.some(e=>e.id===o);p(n?o:0),s(!0)},className:"vmf-folder-manager-button",size:"small",showTooltip:!1}),(0,At.jsx)(n.Button,{icon:Ut,"aria-label":(0,r.__)("Rename Folder","virtual-media-folders"),onClick:e=>{e.stopPropagation(),D&&(b(D.name),y(D.parent||0),_(""),c(!0))},disabled:!N,className:"vmf-folder-manager-button",size:"small",showTooltip:!1}),(0,At.jsx)(n.Button,{icon:Ht,"aria-label":(0,r.__)("Delete Folder","virtual-media-folders"),onClick:e=>{e.stopPropagation(),_(""),f(!0)},disabled:!N,className:"vmf-folder-manager-button",isDestructive:!0,size:"small",showTooltip:!1})]}),l&&(0,At.jsxs)(n.Modal,{title:(0,r.__)("Create Folder","virtual-media-folders"),onRequestClose:()=>s(!1),className:"vmf-folder-modal",children:[(0,At.jsx)(n.TextControl,{label:(0,r.__)("Folder Name","virtual-media-folders"),value:v,onChange:m,placeholder:(0,r.__)("Enter folder name","virtual-media-folders"),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),(0,At.jsx)(n.SelectControl,{label:(0,r.__)("Parent Folder","virtual-media-folders"),value:String(h),options:[{label:(0,r.__)("None (top level)","virtual-media-folders"),value:"0"},...E(e)],onChange:e=>p(parseInt(e,10)),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),S&&(0,At.jsx)("p",{className:"vmf-folder-modal-error",children:S}),(0,At.jsxs)("div",{className:"vmf-folder-modal-actions",children:[(0,At.jsx)(n.Button,{variant:"secondary",onClick:()=>s(!1),disabled:x,children:(0,r.__)("Cancel","virtual-media-folders")}),(0,At.jsx)(n.Button,{variant:"primary",onClick:async function(){if(v.trim()){C(!0),_("");try{await Tt()({path:"/vmf/v1/folders",method:"POST",data:{name:v.trim(),parent:h}}),m(""),p(0),s(!1),R((0,r.__)("Folder created.","virtual-media-folders"),"success"),i?.()}catch(e){_(e.message||(0,r.__)("Failed to create folder.","virtual-media-folders"))}finally{C(!1)}}else _((0,r.__)("Please enter a folder name.","virtual-media-folders"))},disabled:x,children:x?(0,r.__)("Creatingâ€¦","virtual-media-folders"):(0,r.__)("Create","virtual-media-folders")})]})]}),d&&(0,At.jsxs)(n.Modal,{title:(0,r.__)("Edit Folder","virtual-media-folders"),onRequestClose:()=>c(!1),className:"vmf-folder-modal",children:[(0,At.jsx)(n.TextControl,{label:(0,r.__)("Folder Name","virtual-media-folders"),value:g,onChange:b,placeholder:(0,r.__)("Enter folder name","virtual-media-folders"),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),(0,At.jsx)(n.SelectControl,{label:(0,r.__)("Parent Folder","virtual-media-folders"),value:String(w),options:[{label:(0,r.__)("None (top level)","virtual-media-folders"),value:"0"},...E(e,0,0,o)],onChange:e=>y(parseInt(e,10)),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),S&&(0,At.jsx)("p",{className:"vmf-folder-modal-error",children:S}),(0,At.jsxs)("div",{className:"vmf-folder-modal-actions",children:[(0,At.jsx)(n.Button,{variant:"secondary",onClick:()=>c(!1),disabled:x,children:(0,r.__)("Cancel","virtual-media-folders")}),(0,At.jsx)(n.Button,{variant:"primary",onClick:async function(){if(g.trim()){if(o&&"number"==typeof o){C(!0),_("");try{await Tt()({path:`/vmf/v1/folders/${o}`,method:"PUT",data:{name:g.trim(),parent:w}}),b(""),y(0),c(!1),R((0,r.__)("Folder updated.","virtual-media-folders"),"success"),i?.()}catch(e){_(e.message||(0,r.__)("Failed to update folder.","virtual-media-folders"))}finally{C(!1)}}}else _((0,r.__)("Please enter a folder name.","virtual-media-folders"))},disabled:x,children:x?(0,r.__)("Savingâ€¦","virtual-media-folders"):(0,r.__)("Save","virtual-media-folders")})]})]}),u&&(0,At.jsxs)(n.Modal,{title:(0,r.__)("Delete Folder","virtual-media-folders"),onRequestClose:()=>f(!1),className:"vmf-folder-modal",children:[(0,At.jsx)("p",{children:(0,r.sprintf)(/* translators: %s: folder name */ /* translators: %s: folder name */
(0,r.__)('Are you sure you want to delete the folder "%s"?',"virtual-media-folders"),D?.name||"")}),(0,At.jsx)("p",{className:"vmf-folder-modal-warning",children:(0,r.__)("Media items in this folder will not be deleted, only the folder organization.","virtual-media-folders")}),S&&(0,At.jsx)("p",{className:"vmf-folder-modal-error",children:S}),(0,At.jsxs)("div",{className:"vmf-folder-modal-actions",children:[(0,At.jsx)(n.Button,{variant:"secondary",onClick:()=>f(!1),disabled:x,children:(0,r.__)("Cancel","virtual-media-folders")}),(0,At.jsx)(n.Button,{variant:"primary",isDestructive:!0,onClick:async function(){if(o&&"number"==typeof o){C(!0),_("");try{await Tt()({path:`/vmf/v1/folders/${o}`,method:"DELETE"}),f(!1),R((0,r.__)("Folder deleted.","virtual-media-folders"),"success"),a?.(),i?.()}catch(e){_(e.message||(0,r.__)("Failed to delete folder.","virtual-media-folders"))}finally{C(!1)}}},disabled:x,children:x?(0,r.__)("Deletingâ€¦","virtual-media-folders"):(0,r.__)("Delete","virtual-media-folders")})]})]})]})}function Kt({onComplete:e}){const[n,o]=(0,t.useState)([]),[i,a]=(0,t.useState)(""),[l,s]=(0,t.useState)(!1),[d,c]=(0,t.useState)(0),u=(0,t.useCallback)(async()=>{try{const e=await Tt()({path:"/wp/v2/media-folders?per_page=100"});o(e)}catch(e){console.error("Error fetching folders:",e)}},[]);function f(e,t="success"){const n=document.createElement("div");n.className=`notice notice-${t} vmf-notice is-dismissible`,n.innerHTML=`<p>${e}</p>`,n.style.cssText="position: fixed; top: 40px; right: 20px; z-index: 100000; max-width: 300px;",document.body.appendChild(n),setTimeout(()=>n.remove(),3e3)}return(0,t.useEffect)(()=>{u();const e=()=>{u()};return window.addEventListener("vmf:folders-updated",e),()=>{window.removeEventListener("vmf:folders-updated",e)}},[u]),(0,t.useEffect)(()=>{function e(){const e=document.querySelectorAll(".attachment.selected, .attachment.details");c(e.length)}e();const t=new MutationObserver(e),n=document.querySelector(".attachments");return n&&t.observe(n,{attributes:!0,attributeFilter:["class"],subtree:!0}),document.addEventListener("click",e),()=>{t.disconnect(),document.removeEventListener("click",e)}},[]),0===d?null:(0,At.jsxs)("div",{className:"vmf-bulk-folder-action",children:[(0,At.jsxs)("select",{value:i,onChange:e=>a(e.target.value),disabled:l,className:"vmf-bulk-folder-select",children:[(0,At.jsx)("option",{value:"",children:(0,r.__)("Move to folderâ€¦","virtual-media-folders")}),(0,At.jsx)("option",{value:"uncategorized",children:(0,r.__)("Uncategorized","virtual-media-folders")}),n.map(e=>(0,At.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,At.jsx)("button",{type:"button",className:"button vmf-bulk-folder-apply",onClick:async function(){if(!i)return;const t=function(){const e=document.querySelectorAll(".attachment.selected, .attachment.details"),t=[];return e.forEach(e=>{const n=e.getAttribute("data-id");n&&t.push(parseInt(n,10))}),t}();if(0===t.length)return;s(!0);const{ajaxUrl:o,nonce:l}=window.vmfData||{};try{const a=t.map(async e=>{const t=new FormData;return t.append("action","vmf_move_to_folder"),t.append("nonce",l),t.append("media_id",e),t.append("folder_id",i),(await fetch(o,{method:"POST",credentials:"same-origin",body:t})).json()});await Promise.all(a);const s="uncategorized"===i?(0,r.__)("Uncategorized","virtual-media-folders"):n.find(e=>e.id===parseInt(i,10))?.name||"";f((0,r.sprintf)(/* translators: 1: number of items, 2: folder name */ /* translators: 1: number of items, 2: folder name */
(0,r.__)('%1$d items moved to "%2$s".',"virtual-media-folders"),t.length,s),"success"),window.vmfRefreshFolders&&window.vmfRefreshFolders();const{jumpToFolderAfterMove:d=!1}=window.vmfData||{};d?setTimeout(()=>{if(window.vmfSelectFolder){const e="uncategorized"===i?"uncategorized":parseInt(i,10);window.vmfSelectFolder(e)}},200):!document.querySelector(".attachments-browser")?.classList.contains("vmf-folder-filtered")||t.forEach(e=>{const t=document.querySelector(`.attachment[data-id="${e}"]`);t&&t.remove()});const c=document.querySelector(".select-mode-toggle-button");c&&c.click(),e?.()}catch(e){console.error("Bulk move error:",e),f((0,r.__)("Failed to move some items.","virtual-media-folders"),"error")}finally{s(!1),a("")}},disabled:!i||l,title:l?(0,r.__)("Movingâ€¦","virtual-media-folders"):(0,r.__)("Apply","virtual-media-folders"),"aria-label":l?(0,r.__)("Movingâ€¦","virtual-media-folders"):(0,r.__)("Apply","virtual-media-folders"),children:l?(0,At.jsx)("span",{className:"spinner is-active",style:{margin:0}}):(0,At.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor","aria-hidden":"true",children:(0,At.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})})}),(0,At.jsx)("span",{className:"vmf-bulk-folder-count",children:(0,r.sprintf)(/* translators: %d: number of selected items */ /* translators: %d: number of selected items */
(0,r.__)("%d selected","virtual-media-folders"),d)})]})}const{showAllMedia:qt=!0,showUncategorized:Vt=!0}=window.vmfData||{},Xt=qt?null:"uncategorized";function Qt({onFolderSelect:e}){const[n,r]=(0,t.useState)(""),{folders:i,flatFolders:a,selectedId:l,setSelectedId:s,loading:d,uncategorizedCount:c,fetchFolders:u,handleSelect:f}=function({trackUrl:e=!1,onFolderSelect:n,mediaType:r="",defaultFolder:o=null}={}){const[i,a]=(0,t.useState)([]),[l,s]=(0,t.useState)([]),[d,c]=(0,t.useState)(o),[u,f]=(0,t.useState)(!0),[v,m]=(0,t.useState)(0),h=(0,t.useCallback)(async(e=r)=>{try{const t=await Tt()({path:"/wp/v2/media-folders?per_page=100"});let n={};try{(await Tt()({path:"/vmf/v1/folders"})).forEach((e,t)=>{n[e.id]=t})}catch(e){console.log("Could not fetch folder order, using default")}const r=[...t].sort((e,t)=>{const r=n[e.id],o=n[t.id];return void 0!==r&&void 0!==o?r-o:void 0!==r?-1:void 0!==o?1:e.name.localeCompare(t.name)});let o=null;e&&(o=await Tt()({path:`/vmf/v1/folders/counts?media_type=${encodeURIComponent(e)}`}));const i=r.map(e=>({...e,count:o?o[e.id]||0:e.count}));s(i);const l=function(e){const t={},n=[];return e.forEach(e=>{t[e.id]={...e,children:[]}}),e.forEach(e=>{e.parent&&t[e.parent]?t[e.parent].children.push(t[e.id]):n.push(t[e.id])}),n}(i);a(l);const d=function(e){if(!e||"all"===e)return"";if(e.includes("/")||e.includes(",")){const t=e.split(",")[0].split("/")[0];return["image","video","audio","application","text"].includes(t)?t:""}return e}(e);let c="/wp/v2/media?per_page=1";d&&(c+=`&media_type=${encodeURIComponent(d)}`);const u=await Tt()({path:c,parse:!1}),f=parseInt(u.headers.get("X-WP-Total"),10)||0;let v=0;i.forEach(e=>{v+=e.count||0}),m(Math.max(0,f-v))}catch(e){console.error("Error fetching folders:",e)}finally{f(!1)}},[r]);(0,t.useEffect)(()=>{if(e){const e=new URLSearchParams(window.location.search),t=e.get("vmf_folder"),n=e.get("mode");t?c("uncategorized"===t?"uncategorized":parseInt(t,10)):"folder"===n&&c(o)}h()},[h,e,o]),(0,t.useEffect)(()=>{void 0!==r&&h(r)},[r,h]);const p=(0,t.useCallback)(e=>{c(e),n?.(e)},[n]);return{folders:i,flatFolders:l,selectedId:d,setSelectedId:c,loading:u,uncategorizedCount:v,fetchFolders:h,handleSelect:p}}({trackUrl:!0,onFolderSelect:e,mediaType:n,defaultFolder:Xt}),[v,m]=(0,t.useState)(i);(0,t.useEffect)(()=>{m(i)},[i]),(0,t.useEffect)(()=>{function e(){const e=document.querySelector('select.attachment-filters[id="media-attachment-filters"], select.attachment-filters[id*="media-attachment"]');if(e){const t=e.value;return"all"===t?"":t}return""}function t(e){if(e.target.matches("select.attachment-filters")&&("media-attachment-filters"===e.target.id||e.target.id.includes("media-attachment"))){const t=e.target.value;r("all"===t?"":t)}}if(r(e()),document.addEventListener("change",t),"undefined"!=typeof wp&&wp.media&&wp.media.frame){const t=wp.media.frame;if(t.content&&t.content.get){const n=t.content.get();n&&n.collection&&n.collection.on("change:type",()=>{r(e())})}}return()=>{document.removeEventListener("change",t)}},[]);const h=(0,t.useCallback)(e=>{f(e)},[f]),p=(0,t.useCallback)(()=>{const t=c>0?"uncategorized":null;s(t),e?.(t)},[c,s,e]),g=(0,t.useCallback)(()=>{u(),window.dispatchEvent(new CustomEvent("vmf:folders-updated"))},[u]);(0,t.useEffect)(()=>(window.vmfRefreshFolders=g,window.vmfSelectFolder=t=>{s(t),e?.(t)},()=>{delete window.vmfRefreshFolders,delete window.vmfSelectFolder}),[g,e,s]);const b=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,o.useMemo)(()=>[...t].filter(e=>null!=e),[...t])}(B(ke,{activationConstraint:{distance:8}}),B(Ee,{coordinateGetter:Mt})),w=(0,t.useCallback)(e=>{const{active:t,over:n}=e;if(!n||t.id===n.id)return;const r=v.map(e=>e.id),o=r.indexOf(t.id),i=r.indexOf(n.id);if(-1===o||-1===i)return;const a=ft(r,o,i);m(e=>ft(e,o,i)),Tt()({path:"/vmf/v1/folders/reorder",method:"POST",data:{order:a,parent:0}}).catch(e=>{console.error("Failed to reorder folders:",e),u()})},[v,u]),y=v.map(e=>e.id),x=(0,t.useCallback)(({folderId:e,children:t})=>(0,At.jsx)(Pt,{id:e,disabled:"number"!=typeof e,children:(0,At.jsx)(zt,{folderId:e,children:t})}),[]),C=(0,t.useCallback)(({children:e})=>(0,At.jsx)(zt,{folderId:"uncategorized",children:e}),[]),S=(0,t.useCallback)(()=>(0,At.jsxs)(At.Fragment,{children:[(0,At.jsx)(Wt,{folders:a,selectedId:l,onRefresh:g,onDelete:p}),(0,At.jsx)(Kt,{onComplete:g})]}),[a,l,g,p]);return(0,At.jsx)(st,{sensors:b,collisionDetection:X,onDragEnd:w,children:(0,At.jsx)(yt,{items:y,strategy:gt,children:(0,At.jsx)(Ot,{folders:v,selectedId:l,onSelect:h,uncategorizedCount:c,showAllMedia:qt,showUncategorized:Vt,loading:d,renderWrapper:x,renderUncategorizedWrapper:C,renderHeader:S,enableKeyboardNav:!0,enableAutoExpand:!0,enableAria:!0,loadingText:"Loading foldersâ€¦"})})})}let Yt=!1,Jt=null,Gt=null;function Zt(e,t="success"){const n=document.createElement("div");n.className=`notice notice-${t} vmf-notice is-dismissible`,n.innerHTML=`<p>${e}</p>`,n.style.cssText="position: fixed; top: 40px; right: 20px; z-index: 100000; max-width: 300px;",document.body.appendChild(n),setTimeout(()=>n.remove(),3e3)}function en(){jQuery(".view-switch a").removeClass("current")}function tn(e,t){Yt=t;const n=e.$el.find("#vmf-folder-tree"),r=jQuery(".vmf-folder-toggle-button");t?(n.addClass("is-visible"),r.addClass("is-active"),document.body.classList.add("vmf-folder-view-active"),e.$el.addClass("vmf-sidebar-visible"),en(),setTimeout(en,100),setTimeout(en,500),function(e){const t=e.$el.find(".attachments");function n(){t.find('.attachment:not([draggable="true"])').each(function(){const e=jQuery(this);e.attr("draggable","true");const t=e.data("id");t&&e.data("attachment-id",t)})}t.length&&(n(),new MutationObserver(n).observe(t[0],{childList:!0,subtree:!0}),t.off("dragstart.mm dragend.mm"),t.on("dragstart.mm",".attachment",function(e){const t=jQuery(this);let n=t.data("attachment-id")||t.data("id");if(!n){const e=t.attr("aria-label");if(e){const t=e.match(/id[:\s]+(\d+)/i);t&&(n=parseInt(t[1],10))}}n&&(e.originalEvent.dataTransfer.setData("text/plain",JSON.stringify({mediaId:n,title:t.find(".filename").text()||"",thumbnail:t.find("img").attr("src")||""})),e.originalEvent.dataTransfer.effectAllowed="move",t.addClass("vmf-dragging"),document.body.classList.add("vmf-internal-drag"))}),t.on("dragend.mm",".attachment",function(){jQuery(this).removeClass("vmf-dragging"),document.body.classList.remove("vmf-internal-drag")}))}(e),function(e){const t=()=>{const n=document.querySelector(".vmf-folder-tree-sidebar"),r=e.$el.find(".attachments-wrapper")[0],o=e.$el.find(".attachments")[0];if(!n)return void setTimeout(t,100);if(!r||!o)return;let i=!1;function a(){const e=window.getComputedStyle(o),t=parseInt(e.paddingTop,10)||0;return(o.offsetTop||0)+t+8}let l=a();function s(){l=a(),l<0&&(l=0),c()}setTimeout(s,100),setTimeout(s,300),setTimeout(s,600);const d=e.$el.find(".uploader-inline")[0];function c(){const e=o.getBoundingClientRect().top,t=r.getBoundingClientRect();e>=32?(n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.transform=`translateY(${l}px)`):(n.style.position="fixed",n.style.top="32px",n.style.left=`${t.left}px`,n.style.transform="translateY(0)"),i=!1}function u(){i||(requestAnimationFrame(c),i=!0)}function f(){s()}d&&new MutationObserver(()=>{setTimeout(s,50)}).observe(d,{attributes:!0,attributeFilter:["style","class"]}),window.addEventListener("scroll",u,{passive:!0}),window.addEventListener("resize",f,{passive:!0}),c(),n._recalculateOffset=s,n._cleanupSticky=()=>{window.removeEventListener("scroll",u),window.removeEventListener("resize",f)}};t()}(e)):(n.removeClass("is-visible"),r.removeClass("is-active"),document.body.classList.remove("vmf-folder-view-active"),e.$el.removeClass("vmf-sidebar-visible"),jQuery(".view-switch a.view-grid").addClass("current")),localStorage.setItem("vmf_folder_view",t?"1":"0")}function nn(){if("undefined"==typeof wp||void 0===wp.media)return;const e=wp.media.view.AttachmentsBrowser.prototype.render;wp.media.view.AttachmentsBrowser.prototype.render=function(){const o=e.apply(this,arguments);return function(e){if(e.$el.find("#vmf-folder-tree").length)return;const o=document.createElement("div");o.id="vmf-folder-tree",o.className="vmf-folder-tree-sidebar";const i=e.$el.find(".attachments-wrapper").first(),a=e.$el;i.length?i.prepend(o):a.prepend(o),Jt=(0,t.createRoot)(o),Jt.render((0,At.jsxs)(n.SlotFillProvider,{children:[(0,At.jsx)(Qt,{onFolderSelect:t=>{const n=new URL(window.location);t?n.searchParams.set("vmf_folder",t):n.searchParams.delete("vmf_folder"),n.searchParams.set("mode","folder"),window.history.pushState({},"",n);const r=e.collection;if(r){const n=r.props.get("orderby")||"date",o=r.props.get("order")||"DESC",i=e.$el.find(".attachments");i.addClass("vmf-loading");const a=e.$el.hasClass("vmf-folder-filtered"),l=null!==t;if(l?e.$el.addClass("vmf-folder-filtered"):e.$el.removeClass("vmf-folder-filtered"),a!==l){const e=document.querySelector(".vmf-folder-tree-sidebar");e&&e._recalculateOffset&&setTimeout(()=>e._recalculateOffset(),50)}r.props.unset("media_folder"),r.props.unset("media_folder_exclude"),"uncategorized"===t?r.props.set({media_folder_exclude:"all",orderby:n,order:o}):t?r.props.set({media_folder:t,orderby:n,order:o}):r.props.set({orderby:n,order:o}),r.reset(),r.more({remove:!1}).then(()=>{i.removeClass("vmf-loading")}).catch(()=>{i.removeClass("vmf-loading")})}}}),(0,At.jsx)(n.Popover.Slot,{})]})),function(e){if(Gt=e,!jQuery(".vmf-folder-toggle-button").length){const t='<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" aria-hidden="true" focusable="false"><path d="M4 5a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-7.5l-2-2H4z"/></svg>',n=e.$el.find(".media-toolbar-secondary");if(n.length){const o=jQuery(`\n\t\t\t\t<button type="button" class="vmf-folder-toggle-button" title="${(0,r.__)("Show Folders","virtual-media-folders")}">\n\t\t\t\t\t<span class="screen-reader-text">${(0,r.__)("Show Folders","virtual-media-folders")}</span>\n\t\t\t\t\t${t}\n\t\t\t\t</button>\n\t\t\t`);n.prepend(o),o.on("click",t=>{t.preventDefault(),tn(e,!0)})}}const t=localStorage.getItem("vmf_folder_view"),n=new URLSearchParams(window.location.search);("1"===t||n.has("vmf_folder")||"folder"===n.get("mode"))&&tn(e,!0)}(e)}(this),o}}jQuery(document).on("click",".view-switch a",function(){!function(){Yt=!1,localStorage.setItem("vmf_folder_view","0");const e=jQuery("#vmf-folder-tree"),t=jQuery(".vmf-folder-toggle-button");e.removeClass("is-visible"),t.removeClass("is-active"),document.body.classList.remove("vmf-folder-view-active"),jQuery(".attachments-browser").removeClass("vmf-sidebar-visible")}()}),jQuery(document).on("click",".page-title-action",function(){jQuery(".attachments-browser").hasClass("vmf-folder-filtered")&&"function"==typeof window.vmfSelectFolder&&window.vmfSelectFolder(null)}),jQuery(document).ready(function(){!function(){const e=localStorage.getItem("vmf_folder_view"),t=new URLSearchParams(window.location.search);let n=t.has("vmf_folder")||"folder"===t.get("mode");n||null===e||(n="1"===e);const o=jQuery(".vmf-folder-toggle-button");if(o.length)return void(n&&o.addClass("is-active"));const i=jQuery(".view-switch");if(i.length){const e=jQuery(`\n\t\t\t<a href="#" class="vmf-folder-toggle-button${n?" is-active":""}" title="${(0,r.__)("Show Folders","virtual-media-folders")}">\n\t\t\t\t<span class="screen-reader-text">${(0,r.__)("Show Folders","virtual-media-folders")}</span>\n\t\t\t\t<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" aria-hidden="true" focusable="false"><path d="M4 5a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-7.5l-2-2H4z"/></svg>\n\t\t\t</a>\n\t\t`);i.before(e),e.on("click",t=>{if(t.preventDefault(),"list"===new URLSearchParams(window.location.search).get("mode"))return localStorage.setItem("vmf_folder_view","1"),void(window.location.href=window.location.pathname+"?mode=grid");Gt?tn(Gt,!0):(localStorage.setItem("vmf_folder_view","1"),Yt=!0,e.addClass("is-active"))})}}()}),window.vmfMoveToFolder=async function(e,t){const{ajaxUrl:n,nonce:o}=window.vmfData||{};if(!n||!o)return void console.error("Virtual Media Folders: Missing AJAX configuration");const i=new FormData;i.append("action","vmf_move_to_folder"),i.append("nonce",o),i.append("media_id",e),i.append("folder_id",null!=t?t:"");try{const e=await fetch(n,{method:"POST",credentials:"same-origin",body:i}),t=await e.json();t.success?(t.data?.message&&Zt(t.data.message,"success"),window.vmfRefreshFolders&&window.vmfRefreshFolders(),function(){if(!document.querySelector(".attachments-browser")?.classList.contains("vmf-folder-filtered"))return;const e=jQuery(".vmf-folder-button.is-selected");if(e.length)setTimeout(()=>{e.trigger("click")},100);else try{if(wp.media?.frame?.content?.get){const e=wp.media.frame.content.get();if(e&&e.collection){const t=e.collection.props.get("orderby")||"date",n=e.collection.props.get("order")||"DESC";e.collection.reset(),e.collection.props.set({orderby:t,order:n}),e.collection.more({remove:!1})}}}catch(e){console.error("Error refreshing media library:",e)}}()):Zt(t.data?.message||(0,r.__)("Failed to move media.","virtual-media-folders"),"error")}catch(e){console.error("Error moving media:",e),Zt((0,r.__)("Failed to move media.","virtual-media-folders"),"error")}},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",nn):nn()})();