(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var s in n)e.o(n,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,n=window.wp.i18n,s=window.wp.apiFetch;var l=e.n(s);const r=window.ReactJSXRuntime;function a({folder:e,selectedId:s,onSelect:l,level:i=0}){const[o,d]=(0,t.useState)(!1),c=e.children&&e.children.length>0,m=s===e.id;return(0,r.jsxs)("li",{className:"mm-folder-item",children:[(0,r.jsxs)("button",{type:"button",className:"mm-folder-button "+(m?"is-selected":""),style:{paddingLeft:16*i+8+"px"},onClick:()=>l(e.id),"aria-current":m?"true":void 0,children:[c&&(0,r.jsx)("span",{className:"mm-folder-toggle",onClick:e=>{e.stopPropagation(),d(!o)},"aria-label":o?(0,n.__)("Collapse","mediamanager"):(0,n.__)("Expand","mediamanager"),children:(0,r.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o?(0,r.jsx)("polyline",{points:"6 9 12 15 18 9"}):(0,r.jsx)("polyline",{points:"9 6 15 12 9 18"})})}),(0,r.jsx)("span",{className:"mm-folder-name",children:e.name}),"number"==typeof e.count&&(0,r.jsxs)("span",{className:"mm-folder-count",children:["(",e.count,")"]})]}),c&&o&&(0,r.jsx)("ul",{className:"mm-folder-children",children:e.children.map(e=>(0,r.jsx)(a,{folder:e,selectedId:s,onSelect:l,level:i+1},e.id))})]})}function i({onFolderSelect:e}){const[s,i]=(0,t.useState)([]),[o,d]=(0,t.useState)(null),[c,m]=(0,t.useState)(!0),[p,h]=(0,t.useState)(0),u=(0,t.useCallback)(async()=>{try{const e=await l()({path:"/wp/v2/media-folders?per_page=100&hierarchical=1"}),t=function(e){const t={},n=[];return e.forEach(e=>{t[e.id]={...e,children:[]}}),e.forEach(e=>{e.parent&&t[e.parent]?t[e.parent].children.push(t[e.id]):n.push(t[e.id])}),n}(e);i(t);const n=await l()({path:"/wp/v2/media?per_page=1",parse:!1}),s=parseInt(n.headers.get("X-WP-Total"),10)||0;let r=0;e.forEach(e=>{r+=e.count||0}),h(Math.max(0,s-r))}catch(e){console.error("Error fetching folders:",e)}finally{m(!1)}},[]);function f(t){d(t),e?.(t)}return(0,t.useEffect)(()=>{u()},[u]),c?(0,r.jsx)("div",{className:"mm-folder-sidebar mm-folder-sidebar--loading",children:(0,r.jsx)("p",{children:(0,n.__)("Loadingâ€¦","mediamanager")})}):(0,r.jsx)("div",{className:"mm-folder-sidebar",children:(0,r.jsxs)("ul",{className:"mm-folder-list",children:[(0,r.jsx)("li",{className:"mm-folder-item",children:(0,r.jsx)("button",{type:"button",className:"mm-folder-button "+(null===o?"is-selected":""),onClick:()=>f(null),"aria-current":null===o?"true":void 0,children:(0,r.jsx)("span",{className:"mm-folder-name",children:(0,n.__)("All Media","mediamanager")})})}),(0,r.jsx)("li",{className:"mm-folder-item",children:(0,r.jsxs)("button",{type:"button",className:"mm-folder-button "+("uncategorized"===o?"is-selected":""),onClick:()=>f("uncategorized"),"aria-current":"uncategorized"===o?"true":void 0,children:[(0,r.jsx)("span",{className:"mm-folder-name",children:(0,n.__)("Uncategorized","mediamanager")}),(0,r.jsxs)("span",{className:"mm-folder-count",children:["(",p,")"]})]})}),s.map(e=>(0,r.jsx)(a,{folder:e,selectedId:o,onSelect:f},e.id))]})})}function o(){if(!window.wp?.media?.view?.AttachmentsBrowser)return void setTimeout(o,100);const e=wp.media.view.AttachmentsBrowser.prototype.render;wp.media.view.AttachmentsBrowser.prototype.render=function(){if(e.apply(this,arguments),!this.$el.find(".mm-editor-folder-sidebar").length){const e=this.$el.find(".attachments-wrapper").first(),n=this.$el.find(".attachments").first();if(e.length||n.length){const s=document.createElement("div");s.className="mm-editor-folder-sidebar",e.length?e.prepend(s):n.before(s);const l=this.collection,r=this;(0,t.createRoot)(s).render((0,t.createElement)(i,{onFolderSelect:e=>{if(!l)return;const t=r.$el.find(".attachments");t.addClass("mm-loading"),null!==e?r.$el.addClass("mm-folder-filtered"):r.$el.removeClass("mm-folder-filtered"),l.props.unset("media_folder"),l.props.unset("media_folder_exclude"),"uncategorized"===e?l.props.set({media_folder_exclude:"all"}):e&&""!==e&&l.props.set({media_folder:parseInt(e,10)}),l.reset(),l.more({remove:!1}).then(()=>{t.removeClass("mm-loading")}).catch(()=>{t.removeClass("mm-loading")})}})),this.$el.addClass("mm-has-folder-sidebar"),function(e,t){const n=e.$el.find(".attachments-wrapper").first(),s=e.$el.find(".attachments").first();if(!n.length||!s.length)return;const l=n[0];let r=!1;function a(){const e=l.getBoundingClientRect(),n=l.scrollTop>0;n&&!r?(t.style.position="fixed",t.style.top=`${e.top}px`,t.style.left=`${e.left}px`,t.style.height=`${e.height}px`,t.style.width="220px",t.style.zIndex="100",r=!0):!n&&r?(t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.height="100%",t.style.width="",t.style.zIndex="",r=!1):r&&(t.style.top=`${e.top}px`,t.style.left=`${e.left}px`,t.style.height=`${e.height}px`)}l.addEventListener("scroll",()=>{requestAnimationFrame(a)},{passive:!0}),window.addEventListener("resize",a,{passive:!0}),setTimeout(a,100)}(this,s)}}return this}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o()})();